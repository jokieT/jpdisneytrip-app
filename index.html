<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOKYO 2026 - Japan Trip</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        body { background-color: #1a1b1e; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        /* Neumorphism Styles */
        .shadow-neu { box-shadow: 6px 6px 12px #121315, -6px -6px 12px #222327; }
        .shadow-neu-inner { box-shadow: inset 4px 4px 8px #121315, inset -4px -4px 8px #222327; }
        .glass-panel { background: rgba(37, 38, 43, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
    </style>
</head>
<body class="text-gray-200 pb-28">

    <div id="app">
        <!-- Sticky Header -->
        <header class="sticky top-0 z-30 bg-[#1a1b1e]/95 backdrop-blur-md px-6 py-4 border-b border-gray-800 flex justify-between items-center shadow-lg">
            <div><h1 class="text-2xl font-black tracking-widest text-white">{{ tripTitle }}</h1><p class="text-xs text-blue-400 font-mono tracking-wide">{{ tripDate }}</p></div>
            <button class="p-2 rounded-full bg-[#25262b] shadow-neu active:shadow-neu-inner transition-all">âš™ï¸</button>
        </header>
       <main class="p-4 max-w-lg mx-auto space-y-8">
            
            <!-- TAB 1: ITINERARY (è¡Œç¨‹) -->
            <div v-if="activeTab === 'itinerary'" class="space-y-8">
                <!-- Smart Add Card -->
                <div class="p-5 rounded-2xl bg-[#25262b] shadow-neu border border-gray-800">
                    <h2 class="text-xs font-bold text-gray-400 mb-3 uppercase tracking-wider">ğŸ“ æ™ºèƒ½è¡Œç¨‹ (Smart Add)</h2>
                    
                    <!-- Scope Select -->
                    <div class="mb-3 p-1 bg-[#1a1b1e] rounded-xl flex shadow-neu-inner">
                        <button @click="currentScope='land'" :class="currentScope==='land' ? 'bg-pink-600 text-white shadow-lg' : 'text-gray-500'" class="flex-1 py-2 rounded-lg text-xs font-bold transition-all">Land</button>
                        <button @click="currentScope='sea'" :class="currentScope==='sea' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-500'" class="flex-1 py-2 rounded-lg text-xs font-bold transition-all">Sea</button>
                        <button @click="currentScope='hotel'" :class="currentScope==='hotel' ? 'bg-yellow-600 text-white shadow-lg' : 'text-gray-500'" class="flex-1 py-2 rounded-lg text-xs font-bold transition-all">Hotel</button>
                    </div>

                    <!-- Area / Hotel Select -->
                    <select v-model="selectedArea" class="w-full bg-[#1a1b1e] text-sm p-3 mb-3 rounded-xl border-none outline-none shadow-neu-inner text-gray-300">
                        <option value="">{{ currentScope === 'hotel' ? 'ğŸ¨ é¸æ“‡é…’åº— Hotel' : 'ğŸ“ é¸æ“‡å€åŸŸ Area' }}</option>
                        <option v-for="(data, key) in currentDb" :key="key" :value="key">{{ key }}</option>
                    </select>

                    <!-- Category Select -->
                    <div class="flex gap-2 mb-3" v-if="selectedArea">
                        <button v-for="cat in availableCategories" :key="cat.key" @click="selectedCategory=cat.key" :class="selectedCategory===cat.key ? 'bg-gray-600 text-white' : 'bg-[#1a1b1e] text-gray-500'" class="flex-1 py-2 rounded-lg text-xs font-bold shadow-neu-inner border border-gray-700 transition-all">{{ cat.label }}</button>
                    </div>

                    <!-- Item Select -->
                    <select v-if="selectedCategory && selectedArea" v-model="selectedItem" @change="fillItemDetails" class="w-full bg-[#1a1b1e] text-sm p-3 mb-3 rounded-xl border-none outline-none shadow-neu-inner text-white">
                        <option value="">ğŸ‘‡ é¸æ“‡é …ç›® Item</option>
                        <option v-for="item in currentItems" :key="item" :value="item">{{ item }}</option>
                    </select>

                    <div class="grid grid-cols-3 gap-3 mb-3">
                        <input v-model="newTime" type="time" class="col-span-1 bg-[#1a1b1e] rounded-xl p-3 text-sm border-none shadow-neu-inner text-white outline-none">
                        <input v-model="newTitle" type="text" placeholder="æ¨™é¡Œ Title" class="col-span-2 bg-[#1a1b1e] rounded-xl p-3 text-sm border-none shadow-neu-inner text-white outline-none">
                    </div>
                    <input v-model="newNote" type="text" placeholder="å‚™è¨» Notes" class="w-full mb-3 bg-[#1a1b1e] rounded-xl p-3 text-sm border-none shadow-neu-inner text-white outline-none">
                    <input v-model="newMapUrl" type="text" placeholder="åœ°åœ–é€£çµ Map URL" class="w-full mb-4 bg-[#1a1b1e] rounded-xl p-3 text-xs border-none shadow-neu-inner text-gray-500 outline-none">
                    <button @click="addItem(0)" class="w-full py-3 rounded-xl bg-green-600 text-white font-bold shadow-neu hover:bg-green-500 active:scale-95 transition-all">åŠ å…¥ Add</button>
                </div>

                <!-- List -->
                <div v-for="(day, dIndex) in itinerary" :key="dIndex">
                    <div class="flex items-end gap-3 mb-4 px-2"><h2 class="text-3xl font-black text-white">{{ day.day }}</h2><span class="text-sm text-gray-500 font-mono mb-1.5">{{ day.date }}</span></div>
                    <div class="space-y-4 pl-4 border-l-2 border-gray-800 ml-2">
                        <div v-for="item in day.items" :key="item.id" class="relative p-4 rounded-xl bg-[#25262b] shadow-neu border border-gray-800 flex gap-4 overflow-hidden group">
                            <div class="absolute -left-[23px] top-6 w-3 h-3 rounded-full border-2 border-[#1a1b1e]" :class="getTypeColor(item.type)"></div>
                            <div class="flex flex-col items-center min-w-[50px] pt-1 border-r border-gray-700/50 pr-4"><span class="text-sm font-bold text-gray-400">{{ item.time }}</span></div>
                            <div class="flex-1">
                                <h3 class="font-bold text-white text-lg leading-snug">{{ item.title }}</h3>
                                <p v-if="item.note" class="text-xs text-gray-400 mt-2 bg-black/20 p-2 rounded-lg inline-block">{{ item.note }}</p>
                                <button v-if="item.mapUrl" @click="openMap(item.mapUrl)" class="block mt-3 text-xs bg-[#1a1b1e] text-blue-400 px-3 py-2 rounded-lg shadow-neu-inner">ğŸ“ åœ°åœ–</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 2: PACKING -->
            <div v-if="activeTab === 'packing'" class="space-y-6">
                 <div class="p-6 rounded-2xl bg-[#25262b] shadow-neu border border-gray-800 relative overflow-hidden">
                    <div class="flex justify-between items-end mb-2 relative z-10"><div><h2 class="text-2xl font-black text-white">è¡Œææ¸…å–®</h2></div><div class="text-right"><span class="text-4xl font-black text-yellow-400">{{ packingProgress }}%</span></div></div>
                    <div class="w-full h-3 bg-[#1a1b1e] rounded-full mt-2 shadow-neu-inner"><div class="h-full bg-yellow-400 rounded-full transition-all duration-700" :style="{ width: packingProgress + '%' }"></div></div>
                </div>
                <div class="flex gap-3"><input v-model="newPackingItem" @keyup.enter="addPack" type="text" placeholder="æ–°å¢ç‰©å“..." class="flex-1 bg-[#25262b] text-sm text-white p-3 rounded-xl shadow-neu-inner outline-none border-none"><button @click="addPack" class="bg-yellow-500 text-black px-5 rounded-xl font-bold shadow-neu">+</button></div>
                <div v-for="(group, key) in packingByCategory" :key="key" v-show="group.items.length > 0" class="space-y-3">
                    <h3 class="text-xs font-bold text-gray-500 uppercase tracking-widest pl-2 mt-4">{{ group.name }}</h3>
                    <div v-for="item in group.items" :key="item.id" class="p-3 rounded-xl bg-[#25262b] shadow-neu border border-gray-800 flex items-center justify-between" :class="{ 'opacity-50 grayscale': item.checked }">
                        <div class="flex items-center gap-4 flex-1 cursor-pointer" @click="item.checked = !item.checked"><div class="w-6 h-6 rounded-lg border-2 flex items-center justify-center" :class="item.checked ? 'border-yellow-500 bg-yellow-500' : 'border-gray-600'"><span v-if="item.checked" class="text-black text-xs font-bold">âœ“</span></div><span class="text-white font-medium">{{ item.name }}</span></div>
                        <div class="flex items-center bg-[#1a1b1e] rounded-lg p-1 shadow-neu-inner"><button @click="updatePack(item, -1)" class="w-8 text-gray-400">-</button><span class="text-sm font-mono text-blue-300 font-bold">{{ item.count }}</span><button @click="updatePack(item, 1)" class="w-8 text-gray-400">+</button></div>
                    </div>
                </div>
            </div>

            <!-- TAB 3: TODO -->
            <div v-if="activeTab === 'todo'" class="space-y-6">
                <div class="p-6 rounded-2xl bg-[#25262b] shadow-neu border border-gray-800">
                    <div class="flex justify-between items-end mb-2"><h2 class="text-2xl font-black text-white">æº–å‚™äº‹é …</h2><span class="text-3xl font-black text-blue-500">{{ todoProgress }}%</span></div>
                    <div class="w-full h-3 bg-[#1a1b1e] rounded-full mt-2 shadow-neu-inner"><div class="h-full bg-blue-500 rounded-full transition-all duration-700" :style="{ width: todoProgress + '%' }"></div></div>
                </div>
                <div class="flex gap-3"><input v-model="newTodo" @keyup.enter="addTodo" placeholder="æ–°å¢å¾…è¾¦..." class="flex-1 bg-[#25262b] p-3 rounded-xl shadow-neu-inner outline-none text-white text-sm"><button @click="addTodo" class="bg-blue-600 px-5 rounded-xl font-bold text-white shadow-neu">+</button></div>
                <div class="space-y-3"><div v-for="todo in todos" :key="todo.id" class="p-4 rounded-xl bg-[#25262b] shadow-neu border border-gray-800 flex items-start gap-4" :class="{ 'opacity-60': todo.status === 'done' }"><button @click="cycleStatus(todo)" class="mt-1 w-5 h-5 rounded-full border-2 transition-all shadow-neu" :class="{ 'border-gray-500': todo.status === 'pending', 'border-yellow-500 bg-yellow-500': todo.status === 'process', 'border-green-500 bg-green-500': todo.status === 'done' }"></button><div class="flex-1"><h3 class="text-white font-medium text-lg" :class="{ 'line-through text-gray-500': todo.status === 'done' }">{{ todo.title }}</h3><span class="text-[10px] uppercase font-bold px-2 py-0.5 rounded bg-[#1a1b1e] text-blue-400 mt-1 inline-block shadow-neu-inner">{{ todo.category }}</span></div></div></div>
            </div>

            <!-- TAB 4: EXPENSE -->
            <div v-if="activeTab === 'expense'" class="space-y-6">
                <div class="p-8 rounded-2xl bg-gradient-to-br from-gray-800 to-[#1a1b1e] border border-gray-700 text-center shadow-neu"><p class="text-gray-400 text-xs font-bold uppercase tracking-widest mb-2">Total</p><h2 class="text-5xl font-black text-white tracking-tighter">Â¥{{ totalExpense.toLocaleString() }}</h2></div>
                <div class="p-4 rounded-2xl bg-[#25262b] shadow-neu border border-gray-800 grid grid-cols-4 gap-3"><input v-model="newExpTitle" placeholder="é …ç›®" class="col-span-2 bg-[#1a1b1e] p-3 rounded-xl shadow-neu-inner text-sm text-white outline-none"><input v-model="newExpPrice" type="number" placeholder="Â¥" class="col-span-1 bg-[#1a1b1e] p-3 rounded-xl shadow-neu-inner text-sm text-white outline-none"><button @click="addExp" class="col-span-1 bg-green-600 rounded-xl font-bold text-white shadow-neu">Add</button></div>
                <div class="space-y-3"><div v-for="exp in expenses" :key="exp.id" class="p-4 bg-[#25262b] rounded-xl border border-gray-800 shadow-neu flex flex-col gap-3"><div class="flex justify-between items-start"><div><span class="text-white font-bold text-lg block">{{ exp.title }}</span><span class="text-xs text-gray-500 font-mono">@ Â¥{{ exp.price.toLocaleString() }}</span></div><span class="font-mono text-green-400 font-bold text-xl">Â¥{{ (exp.price * exp.quantity).toLocaleString() }}</span></div><div class="flex items-center justify-between bg-[#1a1b1e] p-2 rounded-lg shadow-neu-inner"><span class="text-[10px] text-gray-500 font-bold uppercase ml-2">Qty</span><div class="flex items-center gap-3"><button @click="updateExp(exp, -1)" class="w-6 h-6 rounded bg-gray-700 text-white flex items-center justify-center">-</button><span class="text-sm font-mono text-white font-bold w-4 text-center">{{ exp.quantity }}</span><button @click="updateExp(exp, 1)" class="w-6 h-6 rounded bg-gray-700 text-white flex items-center justify-center">+</button></div></div></div></div>
            </div>
        </main>
       <!-- Bottom Nav -->
        <nav class="fixed bottom-6 left-6 right-6 h-20 bg-[#25262b]/95 backdrop-blur-xl rounded-2xl flex justify-around items-center px-2 shadow-[0_20px_40px_rgba(0,0,0,0.6)] border border-gray-700/50 z-40">
            <button @click="activeTab='itinerary'" :class="activeTab==='itinerary'?'text-blue-400 -translate-y-1':'text-gray-600'" class="flex flex-col items-center gap-1 p-2 transition-all duration-300"><span class="text-2xl">ğŸ“…</span><span class="text-[10px] font-bold">è¡Œç¨‹</span></button>
            <button @click="activeTab='packing'" :class="activeTab==='packing'?'text-yellow-400 -translate-y-1':'text-gray-600'" class="flex flex-col items-center gap-1 p-2 transition-all duration-300"><span class="text-2xl">ğŸ§³</span><span class="text-[10px] font-bold">è¡Œæ</span></button>
            <button @click="activeTab='todo'" :class="activeTab==='todo'?'text-purple-400 -translate-y-1':'text-gray-600'" class="flex flex-col items-center gap-1 p-2 transition-all duration-300"><span class="text-2xl">âœ…</span><span class="text-[10px] font-bold">å¾…è¾¦</span></button>
            <button @click="activeTab='expense'" :class="activeTab==='expense'?'text-green-400 -translate-y-1':'text-gray-600'" class="flex flex-col items-center gap-1 p-2 transition-all duration-300"><span class="text-2xl">ğŸ’°</span><span class="text-[10px] font-bold">è¨˜å¸³</span></button>
        </nav>

        <!-- Map Modal -->
        <div v-if="activeMapUrl" class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4 animate-fade" @click.self="closeMap">
            <div class="w-full max-w-3xl bg-[#1a1b1e] rounded-2xl overflow-hidden shadow-2xl border border-gray-700 flex flex-col h-[70vh]">
                <div class="flex justify-between items-center p-4 bg-[#25262b] border-b border-gray-700"><h3 class="text-white font-bold text-lg">ğŸ—ºï¸ åœ°åœ–å°èˆª</h3><button @click="closeMap" class="w-10 h-10 rounded-full bg-[#1a1b1e] text-gray-400 shadow-neu-inner">âœ•</button></div>
                <iframe :src="activeMapUrl" class="flex-1 w-full border-0"></iframe>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed } = Vue;
        createApp({
            setup() {
                const activeTab = ref('itinerary');
                const tripTitle = ref('TOKYO 2026');
                const tripDate = ref('JAN 26 - JAN 31');
                const activeMapUrl = ref(null);
                
                // --- DISNEY DB (Full) ---
                const disneyDB = {
                    land: {
                        "World Bazaar (ä¸–ç•Œå¸‚é›†)": { attractions: ["Omnibus (é›™å±¤å·´å£«)", "Penny Arcade (ä¾¿å£«æ‹±å»Š)"], restaurants: ["Eastside Cafe (æ±è¡—å’–å•¡é¤é¤¨)", "Great American Waffle Co. (æœ€ä½³ç¾åœ‹é¬†é¤…å…¬å¸)", "Restaurant Hokusai (åŒ—é½‹é¤å»³)", "Sweetheart Cafe (ç”œå¿ƒå’–å•¡é¤é¤¨)"], shops: ["Grand Emporium (æ ¼è˜­æ©æ³¢å•†å ´)", "World Bazaar Confectionery (ä¸–ç•Œå¸‚é›†é»å¿ƒåŠ)"] },
                        "Adventureland (æ¢éšªæ¨‚åœ’)": { attractions: ["Pirates of the Caribbean (åŠ å‹’æ¯”æµ·ç›œ)", "Jungle Cruise (å¢æ—å·¡èˆª)", "Western River Railroad (è¥¿éƒ¨æ²¿æ²³éµè·¯)"], restaurants: ["Blue Bayou Restaurant (è—æµ·ç£é¤å»³)", "China Voyager (ä¸­è¯é¤å»³)", "Polynesian Terrace (æ³¢åˆ©å°¼è¥¿äºè‰å£‡é¤å»³)", "Cafe Orleans (å¥§çˆ¾è‰¯å’–å•¡)"], shops: ["Adventureland Bazaar (æ¢éšªæ¨‚åœ’å¸‚é›†)", "Cristal Arts (æ°´æ™¶è—è¡“)"] },
                        "Westernland (è¥¿éƒ¨æ¨‚åœ’)": { attractions: ["Big Thunder Mountain (å·¨é›·å±±)", "Mark Twain Riverboat (é¦¬å…‹åæº«è™Ÿ)"], restaurants: ["Hungry Bear Restaurant (é ‘ç†Šé¤å»³)", "Plaza Pavilion Restaurant (å»£å ´æ¨“é–£é¤å»³)", "Camp Woodchuck Kitchen (åœŸæ’¥é¼ ç‡Ÿåœ°å»šæˆ¿)"], shops: ["Western Wear (è¥¿éƒ¨æœè£)", "General Store (é›œè²¨åº—)"] },
                        "Fantasyland (å¤¢å¹»æ¨‚åœ’)": { attractions: ["Enchanted Tale of Beauty and the Beast (ç¾å¥³èˆ‡é‡ç¸)", "Haunted Mansion (å¹½éˆå…¬é¤¨)", "It's a Small World (å°å°ä¸–ç•Œ)", "Pooh's Hunny Hunt (å°ç†Šç¶­å°¼)", "Peter Pan's Flight (å½¼å¾—æ½˜)"], restaurants: ["Queen of Hearts Banquet Hall (ç´…å¿ƒå¥³ç‹å®´æœƒå¤§å»³)", "La Taverne de Gaston (åŠ æ–¯é “é…’é¤¨)", "Captain Hook's Galley (è™å…‹èˆ¹é•·çš„å»šæˆ¿)"], shops: ["Village Shoppes (é„‰æ‘å•†åº—)", "Kingdom Treasures (ç‹åœ‹å¯¶è—)", "Pooh Corner (å°ç†Šç¶­å°¼å°ˆæ«ƒ)"] },
                        "Tomorrowland (æ˜æ—¥æ¨‚åœ’)": { attractions: ["Space Mountain (å¤ªç©ºå±±)", "Star Tours (æ˜Ÿéš›æ—…è¡Œ)", "Monsters, Inc. (æ€ªç¸é›»åŠ›å…¬å¸)", "Baymax Happy Ride (æ¯éºµæ­¡æ¨‚æ­)", "Buzz Lightyear (å·´æ–¯å…‰å¹´)"], restaurants: ["Tomorrowland Terrace (æ˜æ—¥æ¨‚åœ’èˆå°é¤å»³)", "Pan Galactic Pizza Port (æ±éŠ€æ²³æŠ«è–©æ¸¯)"], shops: ["Planet M (è¡Œæ˜ŸM)", "Monster's Inc. Company Store (æ€ªç¸ç¦åˆ©ç¤¾)"] }
                    },
                    sea: {
                        "Mediterranean Harbor (åœ°ä¸­æµ·æ¸¯ç£)": { attractions: ["Soaring: Fantastic Flight (å¤¢å¹»å¥‡èˆª)", "DisneySea Transit Steamer Line (è¿ªå£«å°¼æµ·æ´‹æ¸¡è¼ªèˆªç·š)"], restaurants: ["Cafe Portofino (æ³¢å¤šè²è«¾å’–å•¡)", "Zambini Brothers' Ristorante (å°šæ¯”å°¼å…„å¼Ÿé¤å»³)", "Magellan's (éº¥å“²å€«)"], shops: ["Emporio (æ©æ³¢åˆ©æ­å•†å ´)", "Valentina's Sweets (ç“¦å€«è’‚å¨œç³–æœ)"] },
                        "American Waterfront (ç¾åœ‹æµ·æ¿±)": { attractions: ["Tower of Terror (é©šé­‚å¤å¡”)", "Toy Story Mania! (ç©å…·ç¸½å‹•å“¡)", "Turtle Talk (é¾œé¾œæ¼«è«‡)"], restaurants: ["S.S. Columbia Dining Room (S.S.å“¥å€«æ¯”äºé¤å»³)", "Teddy Roosevelt Lounge (æ³°è¿ªç¾…æ–¯ç¦æ­¡é¨°)", "New York Deli (ç´ç´„ç†Ÿé£Ÿ)"], shops: ["McDuck's Department Store (å²é«˜æ²»ç™¾è²¨å…¬å¸)"] },
                        "Mysterious Island (ç¥ç§˜å³¶)": { attractions: ["Journey to the Center of the Earth (åœ°å¿ƒæ¢éšªä¹‹æ—…)", "20,000 Leagues Under the Sea (æµ·åº•å…©è¬å“©)"], restaurants: ["Vulcania Restaurant (ç«å±±é¤å»³)", "Nautilus Galley (é¸šéµ¡èºè™Ÿå»šæˆ¿)"], shops: ["Nautilus Gifts (é¸šéµ¡èºè™Ÿç¦®å“)"] },
                        "Arabian Coast (é˜¿æ‹‰ä¼¯æµ·å²¸)": { attractions: ["Sindbad's Storybook Voyage (è¾›å·´é”å‚³å¥‡ä¹‹æ—…)", "Jasmine's Flying Carpets (èŒ‰è‰å…¬ä¸»çš„é£›å¤©é­”æ¯¯)"], restaurants: ["Casbah Food Court (å¡æ–¯å·´ç¾é£Ÿå»£å ´)", "Sultan's Oasis (è˜‡ä¸¹ç¶ æ´²)"], shops: ["Agrabah Marketplace (é˜¿æ ¼æ‹‰å·´å¸‚å ´)"] }
                    },
                    hotels: {
                        "Tokyo Disneyland Hotel (æ¨‚åœ’é…’åº—)": { restaurants: ["Sherwood Garden (é›ªä¼å¾·èŠ±åœ’)", "CANNA (å¡ç´)", "Dreamers Lounge (å¤¢æƒ³å®¶)"], shops: ["Disney Mercantile (è¿ªå£«å°¼å•†å ´)"] },
                        "Hotel MiraCosta (æµ·æ´‹è§€æµ·æ™¯)": { restaurants: ["Oceano (æµ·æ´‹å®®)", "Silk Road Garden (çµ²è·¯åœ’)", "BellaVista Lounge (è²æ‹‰ç¶­æ–¯å¡”)"], shops: ["MickeyAngelo Gifts (ç±³å¥‡å®‰å“²ç¾…)"] },
                        "Ambassador Hotel (å¤§ä½¿é£¯åº—)": { restaurants: ["Chef Mickey (ç±³å¥‡å¤§å»š)", "Empire Grill (å¸åœ‹é¤å»³)", "Hana (èŠ± Hana)"], shops: ["Festival Disney (è¿ªå£«å°¼ç¯€æ…¶)"] },
                        "Toy Story Hotel (ç©å…·ç¸½å‹•å“¡)": { restaurants: ["Lotso Garden Cafe (ç†ŠæŠ±å“¥èŠ±åœ’)"], shops: ["Gift Planet (ç¦®å“æ˜Ÿçƒ)"] }
                    }
                };

                const currentScope = ref('land');
                const selectedArea = ref('');
                const selectedCategory = ref('');
                const selectedItem = ref('');
                const newTime = ref('');
                const newTitle = ref('');
                const newNote = ref('');
                const newMapUrl = ref('');

                const currentDb = computed(() => disneyDB[currentScope.value] || {});
                const availableCategories = computed(() => currentScope.value === 'hotel' ? [{ key: 'restaurants', label: 'ğŸ½ï¸ é¤å»³ Food' }, { key: 'shops', label: 'ğŸ›ï¸ å•†åº— Shop' }] : [{ key: 'attractions', label: 'ğŸ¢ è¨­æ–½ Ride' }, { key: 'restaurants', label: 'ğŸ½ï¸ é¤å»³ Food' }, { key: 'shops', label: 'ğŸ›ï¸ å•†åº— Shop' }]);
                const currentItems = computed(() => {
                    if (!selectedArea.value || !selectedCategory.value) return [];
                    const data = currentScope.value === 'hotel' ? disneyDB.hotels[selectedArea.value] : currentDb.value[selectedArea.value];
                    return data ? (data[selectedCategory.value] || []) : [];
                });

                const fillItemDetails = () => { if (selectedItem.value) { newTitle.value = selectedItem.value; if(selectedCategory.value==='attractions') newNote.value='é è¨ˆæ’éšŠ: -- min'; if(selectedCategory.value==='restaurants') newNote.value='é ç´„: --:--'; } };

                const itinerary = ref([{ id: 1, day: 'Day 1', date: '1/26', items: [{ id: 101, time: '10:00', title: 'æˆç”°æ©Ÿå ´ (NRT)', type: 'transport', note: 'CX500', mapUrl: '' }] }]);
                const getTypeColor = (t) => t==='food'?'bg-green-500':(t==='shop'?'bg-yellow-500':(t==='transport'?'bg-blue-500':'bg-pink-500'));
                
                const addItem = (d) => { if(newTitle.value){ let type='activity'; if(selectedCategory.value==='restaurants')type='food'; if(selectedCategory.value==='shops')type='shop'; itinerary.value[d].items.push({id:Date.now(), time:newTime.value||'--:--', title:newTitle.value, type, note:newNote.value, mapUrl:newMapUrl.value}); newTitle.value=''; newNote.value=''; newMapUrl.value=''; }};

                // Packing & Others
                const packingList = ref([{id:'p1', name:'Passport', count:1, category:'docs', checked:false}]);
                const newPackingItem = ref('');
                const packingProgress = computed(() => packingList.value.length ? Math.round((packingList.value.filter(i=>i.checked).length/packingList.value.length)*100) : 0);
                const packingByCategory = computed(() => { const g={docs:{name:'Docs',items:[]},others:{name:'Items',items:[]}}; packingList.value.forEach(i=>{(g[i.category]||g.others).items.push(i)}); return g; });
                const addPack = () => { if(newPackingItem.value) packingList.value.push({id:Date.now(), name:newPackingItem.value, category:'others', count:1, checked:false}); newPackingItem.value=''; };
                const updatePack = (i,n) => { if(i.count+n>0) i.count+=n; };

                const todos = ref([{id:1, title:'è²·ä¿éšª', category:'prep', status:'done'}]);
                const newTodo = ref('');
                const todoProgress = computed(() => todos.value.length ? Math.round((todos.value.filter(t=>t.status==='done').length/todos.value.length)*100) : 0);
                const addTodo = () => { if(newTodo.value) todos.value.push({id:Date.now(), title:newTodo.value, category:'prep', status:'pending'}); newTodo.value=''; };
                const cycleStatus = (t) => { t.status = t.status==='pending'?'process':(t.status==='process'?'done':'pending'); };

                const expenses = ref([{id:1, title:'Skyliner', price:2570, quantity:2}]);
                const newExpTitle = ref(''); const newExpPrice = ref('');
                const totalExpense = computed(() => expenses.value.reduce((a,c)=>a+(c.price*c.quantity),0));
                const addExp = () => { if(newExpTitle.value && newExpPrice.value) expenses.value.push({id:Date.now(), title:newExpTitle.value, price:parseInt(newExpPrice.value), quantity:1}); newExpTitle.value=''; newExpPrice.value=''; };
                const updateExp = (e,n) => { if(e.quantity+n>0) e.quantity+=n; };

                const openMap = (u) => { if(u) activeMapUrl.value=u; };
                const closeMap = () => activeMapUrl.value=null;

                return {
                    activeTab, tripTitle, tripDate, activeMapUrl, openMap, closeMap,
                    disneyDB, currentScope, currentDb, availableCategories, currentItems,
                    selectedArea, selectedCategory, selectedItem, fillItemDetails,
                    newTime, newTitle, newNote, newMapUrl, addItem, itinerary, getTypeColor,
                    packingList, packingProgress, packingByCategory, addPack, updatePack, newPackingItem,
                    todos, todoProgress, addTodo, cycleStatus, newTodo,
                    expenses, totalExpense, addExp, updateExp, newExpTitle, newExpPrice
                };
            }
        }).mount('#app');
    </script>
</body>
</html>

